import 'dart:math';

// Функция, которую мы интегрируем
double f(double x) {
  return x * x * sqrt(16 - x * x);
}

// Метод Симпсона для вычисления интеграла
double simpsonsRule(double a, double b, int n) {
  // Проверка на четность количества подинтервалов n
  if (n % 2 != 0) {
    throw ArgumentError("Количество подинтервалов n должно быть четным.");
  }

  // Вычисляем ширину каждого подинтервала
  double h = (b - a) / n;
  double integral = 0;

  // Добавляем значения функции с весами (по формуле Симпсона)
  integral += f(a) + f(b); // Края подинтервала
  for (int i = 1; i < n; i += 2) {
    double x = a + i * h;
    integral += 4 * f(x); // Умножаем на 4 для нечетных индексов
  }
  for (int i = 2; i < n - 1; i += 2) {
    double x = a + i * h;
    integral += 2 * f(x); // Умножаем на 2 для четных индексов
  }

  // Умножаем на h/3 по формуле Симпсона, чтобы получить интеграл
  integral *= h / 3;
  return integral;
}

void main() {
  // Границы интегрирования
  double a = 2;
  double b = 4;

  // Количество подинтервалов (чем больше, тем точнее результат)
  int n = 1000;

  // Вычисляем интеграл с помощью метода Симпсона
  double integral = simpsonsRule(a, b, n);

  // Выводим результат на экран
  print('Значение интеграла (метод Симпсона): $integral');
}